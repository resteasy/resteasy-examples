== Usage

This is a demonstration of the resteasy tracing feature.

To run the example, you can simply run it with WildFly:

[source,bash]
----
$ mvn wildfly:run
----

After server started, we can access the server and get the tracing info:

[source,bash]
----
$ curl -i http://localhost:8080/tracing-example/level
----

And here is the sample output:

[source,txt]
----
HTTP/1.1 200 OK
X-RESTEasy-Tracing-180: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c MATCH       [ ---- / 90377.40 ms |  ---- %] Resource instance: [org.jboss.resteasy.core.ResourceMethodInvoker @15a29762]
X-RESTEasy-Tracing-181: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c MATCH       [ ---- / 90377.43 ms |  ---- %] Matched method  : public java.lang.String dev.resteasy.tracing.examples.TracingConfigResource.level(jakarta.ws.rs.core.Configuration)
X-RESTEasy-Tracing-182: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c REQ-FILTER  [ 0.00 / 90377.47 ms |  0.00 %] Filter by [org.jboss.resteasy.plugins.providers.jsonp.JsonpPatchMethodFilter @39f08fcd #2147483646]
X-RESTEasy-Tracing-183: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c REQ-FILTER  [ 0.00 / 90377.48 ms |  0.00 %] Filter by [org.jboss.resteasy.plugins.providers.jackson.PatchMethodFilter @5116d6ba #2147483647]
X-RESTEasy-Tracing-184: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c REQ-FILTER  [ 0.00 / 90377.49 ms |  0.00 %] Filter by [org.jboss.resteasy.plugins.providers.sse.SseEventSinkInterceptor @7ce628d4 #2147483647]
X-RESTEasy-Tracing-185: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c REQ-FILTER  [ 0.03 / 90377.49 ms |  0.00 %] Request summary: 3 filters
X-RESTEasy-Tracing-186: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c INVOKE      [ 0.26 / 90377.73 ms |  0.00 %] Resource [org.jboss.resteasy.plugins.server.resourcefactory.POJOResourceFactory @306e6620] method=[public java.lang.String dev.resteasy.tracing.examples.TracingConfigResource.level(jakarta.ws.rs.core.Configuration)]
X-RESTEasy-Tracing-187: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c INVOKE      [ ---- / 90377.85 ms |  ---- %] Response: [org.jboss.resteasy.specimpl.BuiltResponse @131c9fd9 <200/SUCCESSFUL|OK|java.lang.String @5f955399>]
X-RESTEasy-Tracing-188: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c RESP-FILTER [ 0.00 / 90377.99 ms |  0.00 %] Filter by [org.jboss.resteasy.security.doseta.DigitalSigningInterceptor @7f267bb2]
X-RESTEasy-Tracing-189: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c RESP-FILTER [ 0.00 / 90378.00 ms |  0.00 %] Filter by [org.jboss.resteasy.plugins.interceptors.MessageSanitizerContainerResponseFilter @49b110a3 #4000]
X-RESTEasy-Tracing-190: org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@5c54713c MBW         [ ---- / 90378.04 ms |  ---- %] Find MBW for type=[java.lang.String] genericType=[java.lang.String] mediaType=[[jakarta.ws.rs.core.MediaType @45b9c1ef]] annotations=[@jakarta.ws.rs.GET(), @jakarta.ws.rs.Path(value="/level")]
----

To get the tracing info in JSON format, use the following cURL command:

[source,bash]
----
$ curl -i -H "X-RESTEasy-Tracing-Accept-Format: JSON"  http://localhost:8080/tracing-example/level
----

And you will get a raw JSON data in the header:

[source,bash]
----
HTTP/1.1 200 OK
Connection: keep-alive
X-RESTEasy-Tracing-000: [{"event":"START","duration":0,"timestamp":94212984357264,"text":"baseUri=[http://localhost:8080/tracing-example/] requestUri=[http://localhost:8080/tracing-example/level] method=[GET] authScheme=[n/a] accept=*/* accept-encoding=n/a accept-charset=n/a accept-language=n/a content-type=n/a content-length=n/a ","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"START_HEADERS","duration":0,"timestamp":94212984800965,"text":"Other request headers: Accept=[*/*] Host=[localhost:8080] User-Agent=[curl/7.87.0] X-RESTEasy-Tracing-Accept-Format=[JSON] ","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"PRE_MATCH_SUMMARY","duration":8355,"timestamp":94212985646134,"text":"PreMatchRequest summary: 0 filters","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"REQUEST_FILTER_SUMMARY","duration":5237,"timestamp":94212987025706,"text":"Request summary: 0 filters","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MATCH_RUNTIME_RESOURCE","duration":0,"timestamp":94212987382356,"text":"Matched resource: template=[[org.jboss.resteasy.core.registry.ClassExpression @2d81af80]] regexp=[\\Q\\E(.*)] matches=[[org.jboss.resteasy.core.registry.SegmentNode @1b3ce8d1]] from=[]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MATCH_PATH_FIND","duration":0,"timestamp":94212987557773,"text":"Matching path [/level]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MATCH_PATH_SELECTED","duration":0,"timestamp":94212988934103,"text":"Pattern [\\Qlevel\\E] IS selected","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MATCH_SUMMARY","duration":1666823,"timestamp":94212988951598,"text":"RequestMatching summary","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MATCH_RESOURCE","duration":0,"timestamp":94212989178174,"text":"Resource instance: [org.jboss.resteasy.core.ResourceMethodInvoker @51972be7]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MATCH_RESOURCE_METHOD","duration":0,"timestamp":94212989463179,"text":"Matched method  : public java.lang.String dev.resteasy.examples.tracing.TracingConfigResource.level(jakarta.ws.rs.core.Configuration)","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"REQUEST_FILTER","duration":59529,"timestamp":94212989963243,"text":"Filter by [org.jboss.resteasy.plugins.providers.jsonp.JsonpPatchMethodFilter @5a833b9a #2147483646]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"REQUEST_FILTER","duration":13433,"timestamp":94212989987365,"text":"Filter by [org.jboss.resteasy.plugins.providers.jackson.PatchMethodFilter @5a1f3b15 #2147483647]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"REQUEST_FILTER","duration":5846,"timestamp":94212989998868,"text":"Filter by [org.jboss.resteasy.plugins.providers.sse.SseEventSinkInterceptor @123d7a68 #2147483647]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"REQUEST_FILTER_SUMMARY","duration":115546,"timestamp":94212990003398,"text":"Request summary: 3 filters","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"METHOD_INVOKE","duration":76770122,"timestamp":94213066355478,"text":"Resource [org.jboss.resteasy.plugins.server.resourcefactory.POJOResourceFactory @8496b40] method=[public java.lang.String dev.resteasy.examples.tracing.TracingConfigResource.level(jakarta.ws.rs.core.Configuration)]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"DISPATCH_RESPONSE","duration":0,"timestamp":94213066942642,"text":"Response: [org.jboss.resteasy.specimpl.BuiltResponse @6871061f <200/SUCCESSFUL|OK|java.lang.String @29910987>]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"RESPONSE_FILTER","duration":9526,"timestamp":94213071317561,"text":"Filter by [org.jboss.resteasy.security.doseta.DigitalSigningInterceptor @4502d2bd]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"RESPONSE_FILTER","duration":4076,"timestamp":94213071334875,"text":"Filter by [org.jboss.resteasy.plugins.interceptors.MessageSanitizerContainerResponseFilter @77188001 #4000]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_FIND","duration":0,"timestamp":94213073383823,"text":"Find MBW for type=[java.lang.String] genericType=[java.lang.String] mediaType=[[jakarta.ws.rs.core.MediaType @e7c913c]] annotations=[@jakarta.ws.rs.GET(), @jakarta.ws.rs.Path(\"/level\")]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SELECTED","duration":0,"timestamp":94213073401228,"text":"[org.jboss.resteasy.plugins.providers.StringTextStar @5d697841] IS writeable","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073412293,"text":"[org.jboss.resteasy.plugins.providers.ReaderProvider @32e81782] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073418786,"text":"[org.jboss.resteasy.plugins.providers.DataSourceProvider @5f77da40] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073421988,"text":"[org.jboss.resteasy.plugins.providers.FileRangeWriter @6eb23b19] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073425715,"text":"[org.jboss.resteasy.plugins.providers.FileProvider @42db282] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073429247,"text":"[org.jboss.resteasy.security.smime.EnvelopedWriter @760be182] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073432134,"text":"[org.jboss.resteasy.plugins.providers.ByteArrayProvider @174f90d9] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073435413,"text":"[org.jboss.resteasy.plugins.providers.StreamingOutputProvider @68da1bda] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073438426,"text":"[org.jboss.resteasy.plugins.providers.AsyncStreamingOutputProvider @10a0de1] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213073442144,"text":"[org.jboss.resteasy.plugins.providers.InputStreamProvider @2824fbb3] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_FIND","duration":0,"timestamp":94213074100692,"text":"Find MBW for type=[java.lang.String] genericType=[java.lang.String] mediaType=[[jakarta.ws.rs.core.MediaType @e7c913c]] annotations=[@jakarta.ws.rs.GET(), @jakarta.ws.rs.Path(\"/level\")]","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SELECTED","duration":0,"timestamp":94213074111314,"text":"[org.jboss.resteasy.plugins.providers.StringTextStar @5d697841] IS writeable","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074115836,"text":"[org.jboss.resteasy.plugins.providers.ReaderProvider @32e81782] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074119125,"text":"[org.jboss.resteasy.plugins.providers.DataSourceProvider @5f77da40] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074122013,"text":"[org.jboss.resteasy.plugins.providers.FileRangeWriter @6eb23b19] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074124870,"text":"[org.jboss.resteasy.plugins.providers.FileProvider @42db282] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074127647,"text":"[org.jboss.resteasy.security.smime.EnvelopedWriter @760be182] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074130328,"text":"[org.jboss.resteasy.plugins.providers.ByteArrayProvider @174f90d9] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074133076,"text":"[org.jboss.resteasy.plugins.providers.StreamingOutputProvider @68da1bda] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074135797,"text":"[org.jboss.resteasy.plugins.providers.AsyncStreamingOutputProvider @10a0de1] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_SKIPPED","duration":0,"timestamp":94213074138927,"text":"[org.jboss.resteasy.plugins.providers.InputStreamProvider @2824fbb3] is skipped","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"MBW_WRITE_TO","duration":0,"timestamp":94213074143775,"text":"WriteTo by org.jboss.resteasy.plugins.providers.StringTextStar","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"WI_AFTER","duration":3463652,"timestamp":94213077028533,"text":"[org.jboss.resteasy.security.doseta.DigitalSigningInterceptor @445488b4] AFTER context.proceed()","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"WI_SUMMARY","duration":5802248,"timestamp":94213078576360,"text":"WriteTo summary: 1 interceptors","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"RESPONSE_FILTER_SUMMARY","duration":7629795,"timestamp":94213078929228,"text":"Response summary: 2 filters","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"},{"event":"FINISHED","duration":0,"timestamp":94213079164242,"text":"Response status: 200","requestId":"org.jboss.resteasy.plugins.server.servlet.Servlet3AsyncHttpRequest@66bfef8a"}]
Content-Type: application/octet-stream
Content-Length: 7
Date: Wed, 12 Apr 2023 17:21:59 GMT

VERBOSE⏎
----

Above is the basic usage of the sample. You should also see output on the console WildFly is running in as well.